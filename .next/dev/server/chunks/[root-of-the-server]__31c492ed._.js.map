{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnoldokoye/hotbat/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\nimport { PrismaPg } from \"@prisma/adapter-pg\";\nimport { Pool } from \"pg\";\n\nconst connectionString = process.env.DATABASE_URL;\nif (!connectionString) {\n  throw new Error(\"DATABASE_URL is required to initialize Prisma\");\n}\n\n// Ensure a single PrismaClient/Pool instance across hot reloads in dev.\nconst globalForPrisma = globalThis as unknown as {\n  prisma?: PrismaClient;\n  pool?: Pool;\n  adapter?: PrismaPg;\n};\n\n// Create a Pool with SSL verification enabled; rely on system trust or NODE_EXTRA_CA_CERTS for Supabase CA.\nconst pool =\n  globalForPrisma.pool ??\n  new Pool({\n    connectionString,\n    ssl: { rejectUnauthorized: true },\n  });\nconst adapter = globalForPrisma.adapter ?? new PrismaPg(pool);\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    adapter,\n    log: process.env.NODE_ENV === \"development\" ? [\"warn\", \"error\"] : [\"error\"],\n  });\n\nif (process.env.NODE_ENV !== \"production\") {\n  globalForPrisma.pool = pool;\n  globalForPrisma.adapter = adapter;\n  globalForPrisma.prisma = prisma;\n}\n\nexport default prisma;\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;;;;;;AAEA,MAAM,mBAAmB,QAAQ,GAAG,CAAC,YAAY;AACjD,IAAI,CAAC,kBAAkB;IACrB,MAAM,IAAI,MAAM;AAClB;AAEA,wEAAwE;AACxE,MAAM,kBAAkB;AAMxB,4GAA4G;AAC5G,MAAM,OACJ,gBAAgB,IAAI,IACpB,IAAI,4GAAI,CAAC;IACP;IACA,KAAK;QAAE,oBAAoB;IAAK;AAClC;AACF,MAAM,UAAU,gBAAgB,OAAO,IAAI,IAAI,yKAAQ,CAAC;AAEjD,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf;IACA,KAAK,uCAAyC;QAAC;QAAQ;KAAQ,GAAG;AACpE;AAEF,wCAA2C;IACzC,gBAAgB,IAAI,GAAG;IACvB,gBAAgB,OAAO,GAAG;IAC1B,gBAAgB,MAAM,GAAG;AAC3B;uCAEe"}},
    {"offset": {"line": 115, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnoldokoye/hotbat/src/app/api/today-games/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport prisma from \"@/lib/prisma\";\n\ntype TodayGamesResponse = {\n  date: string;\n  games: {\n    id: number;\n    date: string;\n    startTimeLocal?: string;\n    homeTeamId: number;\n    awayTeamId: number;\n    homeTeamName: string;\n    awayTeamName: string;\n    homeTeamAbbrev: string;\n    awayTeamAbbrev: string;\n    homeTeamLogoUrl?: string;\n    awayTeamLogoUrl?: string;\n    parkName: string;\n    parkHrFactor?: number;\n    homePredictedHrMean?: number;\n    awayPredictedHrMean?: number;\n    hotbatScore?: number;\n  }[];\n};\n\nconst parseDate = (value: string | null) => {\n  if (!value) return null;\n  const parsed = new Date(`${value}T00:00:00.000Z`);\n  return Number.isNaN(parsed.getTime()) ? null : parsed;\n};\n\nexport async function GET(req: NextRequest) {\n  const { searchParams } = new URL(req.url);\n  const dateParam = searchParams.get(\"date\");\n  const date = parseDate(dateParam);\n\n  if (!dateParam || !date) {\n    return NextResponse.json(\n      { error: \"date query param is required (YYYY-MM-DD)\" },\n      { status: 400 },\n    );\n  }\n\n  const endOfDay = new Date(date);\n  endOfDay.setUTCDate(endOfDay.getUTCDate() + 1);\n\n  const games = await prisma.game.findMany({\n    where: { date: { gte: date, lt: endOfDay } },\n    orderBy: { date: \"asc\" },\n    include: {\n      homeTeam: true,\n      awayTeam: true,\n      park: {\n        include: {\n          parkHrFactors: {\n            orderBy: { updatedAt: \"desc\" },\n            take: 1,\n          },\n        },\n      },\n      gamePredictions: true,\n    },\n  });\n\n  const response: TodayGamesResponse = {\n    date: dateParam,\n    games: games.map((game) => {\n      const homePrediction = game.gamePredictions.find(\n        (p) => p.teamId === game.homeTeamId,\n      );\n      const awayPrediction = game.gamePredictions.find(\n        (p) => p.teamId === game.awayTeamId,\n      );\n      const parkFactorEntry = game.park.parkHrFactors[0];\n      const hotbatScore =\n        game.gamePredictions.length > 0\n          ? game.gamePredictions.reduce(\n              (total, prediction) => total + prediction.hotbatScore,\n              0,\n            ) / game.gamePredictions.length\n          : undefined;\n\n      return {\n        id: game.id,\n        date: game.date.toISOString(),\n        startTimeLocal: game.startTime?.toISOString(),\n        homeTeamId: game.homeTeamId,\n        awayTeamId: game.awayTeamId,\n        homeTeamName: game.homeTeam.name,\n        awayTeamName: game.awayTeam.name,\n        homeTeamAbbrev: game.homeTeam.abbrev,\n        awayTeamAbbrev: game.awayTeam.abbrev,\n        homeTeamLogoUrl: game.homeTeam.logoUrl ?? undefined,\n        awayTeamLogoUrl: game.awayTeam.logoUrl ?? undefined,\n        parkName: game.park.name,\n        parkHrFactor:\n          parkFactorEntry?.hrFactor ?? game.park.defaultHrFactor ?? undefined,\n        homePredictedHrMean: homePrediction?.predictedHrMean ?? undefined,\n        awayPredictedHrMean: awayPrediction?.predictedHrMean ?? undefined,\n        hotbatScore,\n      };\n    }),\n  };\n\n  return NextResponse.json(response);\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;;;;AAwBA,MAAM,YAAY,CAAC;IACjB,IAAI,CAAC,OAAO,OAAO;IACnB,MAAM,SAAS,IAAI,KAAK,GAAG,MAAM,cAAc,CAAC;IAChD,OAAO,OAAO,KAAK,CAAC,OAAO,OAAO,MAAM,OAAO;AACjD;AAEO,eAAe,IAAI,GAAgB;IACxC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG;IACxC,MAAM,YAAY,aAAa,GAAG,CAAC;IACnC,MAAM,OAAO,UAAU;IAEvB,IAAI,CAAC,aAAa,CAAC,MAAM;QACvB,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA4C,GACrD;YAAE,QAAQ;QAAI;IAElB;IAEA,MAAM,WAAW,IAAI,KAAK;IAC1B,SAAS,UAAU,CAAC,SAAS,UAAU,KAAK;IAE5C,MAAM,QAAQ,MAAM,iIAAM,CAAC,IAAI,CAAC,QAAQ,CAAC;QACvC,OAAO;YAAE,MAAM;gBAAE,KAAK;gBAAM,IAAI;YAAS;QAAE;QAC3C,SAAS;YAAE,MAAM;QAAM;QACvB,SAAS;YACP,UAAU;YACV,UAAU;YACV,MAAM;gBACJ,SAAS;oBACP,eAAe;wBACb,SAAS;4BAAE,WAAW;wBAAO;wBAC7B,MAAM;oBACR;gBACF;YACF;YACA,iBAAiB;QACnB;IACF;IAEA,MAAM,WAA+B;QACnC,MAAM;QACN,OAAO,MAAM,GAAG,CAAC,CAAC;YAChB,MAAM,iBAAiB,KAAK,eAAe,CAAC,IAAI,CAC9C,CAAC,IAAM,EAAE,MAAM,KAAK,KAAK,UAAU;YAErC,MAAM,iBAAiB,KAAK,eAAe,CAAC,IAAI,CAC9C,CAAC,IAAM,EAAE,MAAM,KAAK,KAAK,UAAU;YAErC,MAAM,kBAAkB,KAAK,IAAI,CAAC,aAAa,CAAC,EAAE;YAClD,MAAM,cACJ,KAAK,eAAe,CAAC,MAAM,GAAG,IAC1B,KAAK,eAAe,CAAC,MAAM,CACzB,CAAC,OAAO,aAAe,QAAQ,WAAW,WAAW,EACrD,KACE,KAAK,eAAe,CAAC,MAAM,GAC/B;YAEN,OAAO;gBACL,IAAI,KAAK,EAAE;gBACX,MAAM,KAAK,IAAI,CAAC,WAAW;gBAC3B,gBAAgB,KAAK,SAAS,EAAE;gBAChC,YAAY,KAAK,UAAU;gBAC3B,YAAY,KAAK,UAAU;gBAC3B,cAAc,KAAK,QAAQ,CAAC,IAAI;gBAChC,cAAc,KAAK,QAAQ,CAAC,IAAI;gBAChC,gBAAgB,KAAK,QAAQ,CAAC,MAAM;gBACpC,gBAAgB,KAAK,QAAQ,CAAC,MAAM;gBACpC,iBAAiB,KAAK,QAAQ,CAAC,OAAO,IAAI;gBAC1C,iBAAiB,KAAK,QAAQ,CAAC,OAAO,IAAI;gBAC1C,UAAU,KAAK,IAAI,CAAC,IAAI;gBACxB,cACE,iBAAiB,YAAY,KAAK,IAAI,CAAC,eAAe,IAAI;gBAC5D,qBAAqB,gBAAgB,mBAAmB;gBACxD,qBAAqB,gBAAgB,mBAAmB;gBACxD;YACF;QACF;IACF;IAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC3B"}}]
}