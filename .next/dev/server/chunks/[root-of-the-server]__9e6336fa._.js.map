{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnoldokoye/hotbat/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\nimport { PrismaPg } from \"@prisma/adapter-pg\";\nimport { Pool } from \"pg\";\nimport fs from \"fs\";\nimport path from \"path\";\n\nconst connectionString = process.env.DATABASE_URL;\nif (!connectionString) {\n  throw new Error(\"DATABASE_URL is required to initialize Prisma\");\n}\n\n// Ensure a single PrismaClient/Pool instance across hot reloads in dev.\nconst globalForPrisma = globalThis as unknown as {\n  prisma?: PrismaClient;\n  pool?: Pool;\n  adapter?: PrismaPg;\n  __dbUsedInsecureSsl?: boolean;\n};\n\nconst defaultCaPath =\n  process.env.NODE_EXTRA_CA_CERTS ||\n  path.join(process.cwd(), \"prod-ca-2021.crt\");\nconst caFileExists = defaultCaPath ? fs.existsSync(defaultCaPath) : false;\nconst caBuffer = caFileExists ? fs.readFileSync(defaultCaPath) : undefined;\nconst allowInsecureEnv =\n  process.env.DB_SSL_ALLOW_INSECURE === \"1\" ||\n  process.env.DB_SSL_ALLOW_INSECURE === \"true\" ||\n  process.env.NODE_TLS_REJECT_UNAUTHORIZED === \"0\";\nconst connectionTimeoutMs =\n  Number.parseInt(process.env.DB_CONNECTION_TIMEOUT_MS ?? \"\", 10) || 5000;\n\ntype PoolInit = {\n  pool: Pool;\n  usedInsecure: boolean;\n};\n\nconst buildPool = (rejectUnauthorized: boolean): PoolInit => {\n  const ssl: { rejectUnauthorized: boolean; ca?: Buffer } = { rejectUnauthorized };\n  if (caBuffer) {\n    ssl.ca = caBuffer;\n  }\n  return {\n    pool: new Pool({\n      connectionString,\n      ssl,\n      connectionTimeoutMillis: connectionTimeoutMs,\n    }),\n    usedInsecure: !rejectUnauthorized,\n  };\n};\n\nconst isTlsError = (error: unknown) => {\n  if (!error || typeof error !== \"object\") return false;\n  const code = (error as { code?: string }).code ?? \"\";\n  const message = (error as { message?: string }).message ?? \"\";\n  const tlsCodes = [\n    \"SELF_SIGNED_CERT_IN_CHAIN\",\n    \"DEPTH_ZERO_SELF_SIGNED_CERT\",\n    \"UNABLE_TO_VERIFY_LEAF_SIGNATURE\",\n    \"ERR_TLS_CERT_ALTNAME_INVALID\",\n    \"UNABLE_TO_GET_ISSUER_CERT_LOCALLY\",\n  ];\n  return tlsCodes.includes(code) || message.toLowerCase().includes(\"certificate\");\n};\n\nconst initPool = async (): Promise<PoolInit> => {\n  const primary = buildPool(!allowInsecureEnv);\n\n  const warmupResult = await primary.pool\n    .query(\"SELECT 1\")\n    .then(() => \"ok\" as const)\n    .catch((error) => {\n      if (!allowInsecureEnv && isTlsError(error)) {\n        return \"tls-error\" as const;\n      }\n      console.warn(\n        \"Database warm-up query failed; continuing with current SSL config.\",\n        error,\n      );\n      return \"failed\" as const;\n    });\n\n  if (warmupResult === \"tls-error\") {\n    await primary.pool.end().catch(() => {});\n    console.warn(\n      \"Database TLS verification failed; retrying with rejectUnauthorized=false. \" +\n        \"Provide NODE_EXTRA_CA_CERTS with your trusted root to restore verification.\",\n    );\n    return buildPool(false);\n  }\n\n  return primary;\n};\n\nconst { pool, usedInsecure } =\n  globalForPrisma.pool && typeof globalForPrisma.__dbUsedInsecureSsl === \"boolean\"\n    ? { pool: globalForPrisma.pool, usedInsecure: globalForPrisma.__dbUsedInsecureSsl }\n    : await initPool();\n\nconst adapter = globalForPrisma.adapter ?? new PrismaPg(pool);\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    adapter,\n    log: process.env.NODE_ENV === \"development\" ? [\"warn\", \"error\"] : [\"error\"],\n  });\n\nif (process.env.NODE_ENV !== \"production\") {\n  globalForPrisma.pool = pool;\n  globalForPrisma.adapter = adapter;\n  globalForPrisma.prisma = prisma;\n  globalForPrisma.__dbUsedInsecureSsl = usedInsecure;\n}\n\nexport default prisma;\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;;;AAEA,MAAM,mBAAmB,QAAQ,GAAG,CAAC,YAAY;AACjD,IAAI,CAAC,kBAAkB;IACrB,MAAM,IAAI,MAAM;AAClB;AAEA,wEAAwE;AACxE,MAAM,kBAAkB;AAOxB,MAAM,gBACJ,QAAQ,GAAG,CAAC,mBAAmB,IAC/B,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;AAC3B,MAAM,eAAe,uCAAgB,wGAAE,CAAC,UAAU,CAAC,iBAAiB;AACpE,MAAM,WAAW,eAAe,wGAAE,CAAC,YAAY,CAAC,iBAAiB;AACjE,MAAM,mBACJ,QAAQ,GAAG,CAAC,qBAAqB,KAAK,OACtC,QAAQ,GAAG,CAAC,qBAAqB,KAAK,UACtC,QAAQ,GAAG,CAAC,4BAA4B,KAAK;AAC/C,MAAM,sBACJ,OAAO,QAAQ,CAAC,QAAQ,GAAG,CAAC,wBAAwB,IAAI,IAAI,OAAO;AAOrE,MAAM,YAAY,CAAC;IACjB,MAAM,MAAoD;QAAE;IAAmB;IAC/E,IAAI,UAAU;QACZ,IAAI,EAAE,GAAG;IACX;IACA,OAAO;QACL,MAAM,IAAI,4GAAI,CAAC;YACb;YACA;YACA,yBAAyB;QAC3B;QACA,cAAc,CAAC;IACjB;AACF;AAEA,MAAM,aAAa,CAAC;IAClB,IAAI,CAAC,SAAS,OAAO,UAAU,UAAU,OAAO;IAChD,MAAM,OAAO,AAAC,MAA4B,IAAI,IAAI;IAClD,MAAM,UAAU,AAAC,MAA+B,OAAO,IAAI;IAC3D,MAAM,WAAW;QACf;QACA;QACA;QACA;QACA;KACD;IACD,OAAO,SAAS,QAAQ,CAAC,SAAS,QAAQ,WAAW,GAAG,QAAQ,CAAC;AACnE;AAEA,MAAM,WAAW;IACf,MAAM,UAAU,UAAU,CAAC;IAE3B,MAAM,eAAe,MAAM,QAAQ,IAAI,CACpC,KAAK,CAAC,YACN,IAAI,CAAC,IAAM,MACX,KAAK,CAAC,CAAC;QACN,IAAI,CAAC,oBAAoB,WAAW,QAAQ;YAC1C,OAAO;QACT;QACA,QAAQ,IAAI,CACV,sEACA;QAEF,OAAO;IACT;IAEF,IAAI,iBAAiB,aAAa;QAChC,MAAM,QAAQ,IAAI,CAAC,GAAG,GAAG,KAAK,CAAC,KAAO;QACtC,QAAQ,IAAI,CACV,+EACE;QAEJ,OAAO,UAAU;IACnB;IAEA,OAAO;AACT;AAEA,MAAM,EAAE,IAAI,EAAE,YAAY,EAAE,GAC1B,gBAAgB,IAAI,IAAI,OAAO,gBAAgB,mBAAmB,KAAK,YACnE;IAAE,MAAM,gBAAgB,IAAI;IAAE,cAAc,gBAAgB,mBAAmB;AAAC,IAChF,MAAM;AAEZ,MAAM,UAAU,gBAAgB,OAAO,IAAI,IAAI,yKAAQ,CAAC;AAEjD,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf;IACA,KAAK,uCAAyC;QAAC;QAAQ;KAAQ,GAAG;AACpE;AAEF,wCAA2C;IACzC,gBAAgB,IAAI,GAAG;IACvB,gBAAgB,OAAO,GAAG;IAC1B,gBAAgB,MAAM,GAAG;IACzB,gBAAgB,mBAAmB,GAAG;AACxC;uCAEe"}},
    {"offset": {"line": 179, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnoldokoye/hotbat/src/app/api/slates/latest/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport prisma from \"@/lib/prisma\";\n\nexport async function GET() {\n  try {\n    const latest = await prisma.game.findFirst({\n      orderBy: { date: \"desc\" },\n      select: { date: true },\n    });\n\n    const latestDate = latest ? latest.date.toISOString().slice(0, 10) : null;\n    return NextResponse.json({ latestDate }, { status: 200 });\n  } catch (error) {\n    console.error(\"Error in /api/slates/latest\", error);\n    // Fall back to null latestDate so the UI can show an empty-state message instead of failing.\n    return NextResponse.json({ latestDate: null }, { status: 200 });\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;;;;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,SAAS,MAAM,iIAAM,CAAC,IAAI,CAAC,SAAS,CAAC;YACzC,SAAS;gBAAE,MAAM;YAAO;YACxB,QAAQ;gBAAE,MAAM;YAAK;QACvB;QAEA,MAAM,aAAa,SAAS,OAAO,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC,GAAG,MAAM;QACrE,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE;QAAW,GAAG;YAAE,QAAQ;QAAI;IACzD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,6FAA6F;QAC7F,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,YAAY;QAAK,GAAG;YAAE,QAAQ;QAAI;IAC/D;AACF"}}]
}